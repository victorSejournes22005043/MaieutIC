{% if app.user and app.user.userType == 1 %}
<div id="author-edit-modal" class="fixed inset-0 w-full h-full bg-black bg-opacity-50 flex justify-center items-center z-[1000] hidden">
    <div class="bg-white p-5 rounded-lg w-[90%] max-w-[500px] shadow-lg relative">
        <span class="absolute top-2 right-2 text-2xl cursor-pointer" onclick="closeAuthorEditModal()">&times;</span>
        <h2 class="text-xl font-bold mb-4">Modifier un auteur</h2>
        {{ form_start(form, {'attr': {'id': 'author-edit-form', 'class': 'space-y-4'}, 'action': path('app_author_edit', {'id': 1})}) }}
            {{ form_widget(form, {'attr': {'class': 'w-full p-2 border border-gray-300 rounded'}}) }}
            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Enregistrer</button>
        {{ form_end(form) }}
    </div>
</div>

<script>
    function openAuthorEditModal(id) {
        const form = document.getElementById('author-edit-form');
        const editUrl = `{{ path('app_author_edit', {'id': 'PLACEHOLDER'}) }}`.replace('PLACEHOLDER', id);
        document.getElementById('author-edit-form').action = editUrl;

        fetch(`/library/author/data/${id}`)
            .then(response => response.json())
            .then(data => {
                form.querySelector('[name$="[name]"]').value = data.name;
                form.querySelector('[name$="[birthYear]"]').value = data.birthYear;
                form.querySelector('[name$="[deathYear]"]').value = data.deathYear;
                form.querySelector('[name$="[nationality]"]').value = data.nationality;
                form.querySelector('[name$="[link]"]').value = data.link;
                form.querySelector('[name$="[image]"]').value = data.image;
            });

        document.getElementById('author-edit-modal').classList.remove('hidden');
    }

    function closeAuthorEditModal() {
        document.getElementById('author-edit-modal').classList.add('hidden');
    }
</script>
{% endif %}