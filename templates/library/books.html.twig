{% extends 'base.html.twig' %}

{% block title %}Biblioth√®que{% endblock %}
{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('styles/app.css') }}">
{% endblock %}

{% block body %}

{{ render(controller('App\\Controller\\NavbarController::navbar')) }}

<div class="flex-1 container mx-auto py-6">
    <div class="flex justify-center space-x-4 mb-6">
        <button onclick="window.location.href='{{ path('app_library') }}'" class="bg-white/45 text-gray-700 backdrop-blur-sm shadow-lg flex-grow px-4 py-2 rounded-lg font-medium hover:bg-gray-200/45 focus:outline-none focus:ring-2 focus:ring-gray-400 active:bg-gray-400">Auteurs</button>
        <button onclick="window.location.href='{{ path('app_library_articles') }}'" class="bg-white/45 text-gray-700 backdrop-blur-sm shadow-lg flex-grow px-4 py-2 rounded-lg font-medium hover:bg-gray-200/45 focus:outline-none focus:ring-2 focus:ring-gray-400 active:bg-gray-400">Articles</button>
        <button class="bg-blue-600 text-white flex-grow px-4 py-2 rounded-lg font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 active:bg-blue-900">Livres</button>
    </div>
    <div class="bg-white/45 backdrop-blur-sm shadow-xl flex flex-wrap p-4 rounded-lg">
        {% if app.user and app.user.userType == 1 %}
            <div class="w-full flex justify-end mb-4">
                <button class="inline-block px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition" onclick="openBookCreateModal()">Ajouter un livre</button>
            </div>
        {% endif %}
        {% for book in books %}
        <div class="bg-white hover:bg-blue-50 rounded-lg overflow-hidden relative w-44 h-72 m-4 p-3">
            <a href="{{ book.link }}" target="_blank">
                <img src="{{ book.image }}" alt="{{ book.title }}" class="w-full h-40 object-cover rounded-lg">
            </a>
            <div class="p-4">
                <h3 class="text-lg font-semibold text-gray-800">{{ book.title }}</h3>
                <p class="text-sm text-gray-600">{{ book.author }}</p>
            </div>
            {% if app.user and app.user.userType == 1 %}
                <div class="absolute top-2 right-2 flex space-x-1">
                    <button onclick="openBookEditModal({{ book.id }})"
                            class="bg-yellow-400 hover:bg-yellow-500 text-white px-2 py-1 rounded text-xs font-semibold transition"
                            title="Modifier">
                        ‚úèÔ∏è
                    </button>
                    <form method="post" action="{{ path('app_book_delete', {'id': book.id}) }}" onsubmit="return confirm('Voulez-vous vraiment supprimer ce livre ?');">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete_book_' ~ book.id) }}">
                        <button type="submit"
                                class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs font-semibold transition"
                                title="Supprimer">
                            üóëÔ∏è
                        </button>
                    </form>
                </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
{{ render(controller('App\\Controller\\FooterController::footer')) }}
{% include 'modals/_book_create_modal.html.twig' with {'form': createForm} %}
{% include 'modals/_book_edit_modal.html.twig' with {'form': editForm} %}
{% endblock %}